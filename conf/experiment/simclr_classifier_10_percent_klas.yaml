# @package _global_

defaults:
  - override /datamodule: plankton
  - override /datamodule/dataset: simclr
  - override /loss: simclr_loss
  - override /datamodule/train_transforms: simclr
  - override /datamodule/valid_transforms: simclr
  - override /model/feature_extractor: simclr_resnet
  - override /model/classifier: simclr_classifier
  - override /hydra/launcher: strand
  - _self_

debug: false
load_state_dict:

# set the size of the feature vector for the contrastive loss to be compared:
model:
  classifier:
    num_classes: null
  feature_extractor:
    model:
      _target_: "torchvision.models.wide_resnet101_2"
      num_classes: ${model.classifier.input_features}
      pretrained: false

trainer:
  fast_dev_run: false
  num_sanity_val_steps: 5
  max_epochs: 100
  gpus: 1
  num_nodes: 3
  accelerator: "ddp"

hydra:
  launcher:
    partition: pGPU32
    cpus_per_task: 40
    tasks_per_node: 1
    nodes: 3
    signal_delay_s: 120
    additional_parameters: { exclusive: true }
    array_parallelism: 0

logger:
  tensorboard:
    default_hp_metric: False

datamodule:
  num_workers: 40
  batch_size: 1048
  train_split: 0.1
  validation_split: 0.9

lightning_module:
  log_confusion_matrices: true
  log_images: true
